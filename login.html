<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>FinTrack — Dashboard</title>

<link rel="stylesheet" href="style.css"/>

<style>
/* ===== EXISTING SAFE STYLES ===== */
.top-row{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px;}
#controls{display:flex;gap:10px;align-items:center;}
#filterMonth{padding:8px 10px;border-radius:10px;background:rgba(255,255,255,0.02);color:#fff;border:1px solid rgba(255,255,255,0.03);}
.action-btn{padding:6px 10px;border-radius:8px;border:none;cursor:pointer;font-weight:600;}
.small-note{color:var(--text-soft);font-size:0.9rem;margin-top:6px;}

/* ===== NEW CALENDAR SAFE CSS ===== */
#calendar{
  width:100%;
  max-width:420px;
  margin:0 auto;
}

#calendar .header{
  height:50px;
  background:rgba(66,66,66,0.6);
  text-align:center;
  position:relative;
  border-radius:10px 10px 0 0;
}

#calendar .header h1{
  margin:0;
  line-height:50px;
  font-size:18px;
  color:white;
}

#calendar .day{
  display:inline-block;
  width:14.2%;
  padding:10px;
  text-align:center;
  color:white;
  font-size:14px;
}
</style>
</head>

<body>

<header class="navbar glass-card">
  <div class="brand">
    <span class="brand-text">FinTrack</span>
  </div>
  <button onclick="location.href='login.html'" class="btn-primary">Logout</button>
</header>

<main class="app" style="padding-top:18px;">

<!-- ===== TOP ===== -->
<div class="top-row">
  <div>
    <h2 style="margin:0;color:#fff">Dashboard</h2>
    <div class="small-note">Track expenses and view analytics.</div>
  </div>

  <div id="controls">
    <select id="filterMonth"></select>
    <button id="exportCsv" class="action-btn">Export CSV</button>
  </div>
</div>

<!-- ===== SUMMARY ===== -->
<div class="summary-grid">
  <div class="summary-card"><h3>Income</h3><p id="incomeValue">₹0</p></div>
  <div class="summary-card"><h3>Budget</h3><p id="budgetValue">₹0</p></div>
  <div class="summary-card"><h3>Spent</h3><p id="spentValue">₹0</p></div>
  <div class="summary-card"><h3>Remaining</h3><p id="remainingValue">₹0</p></div>
</div>

<!-- ===== RIGHT PANEL ===== -->
<section class="right-panel">

  <!-- GRAPH -->
  <div class="glass-card card-3d chart-card">
    <h2>Spending by Category</h2>
    <canvas id="expenseChart"></canvas>
  </div>

  <!-- ===== NEW CALENDAR ADDED SAFELY ===== -->
  <div class="glass-card card-3d" style="margin-top:20px;">
    <h2 style="margin-bottom:10px;">Calendar</h2>
    <div id="calendar"></div>
  </div>

</section>

</main>

<!-- ===== LIBRARIES ===== -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={
apiKey:"AIzaSyCnhYkubvXjU_hmVHfVdmt5rcyA1mdIi3A",
authDomain:"expense---tracker-9957e.firebaseapp.com",
projectId:"expense---tracker-9957e",
storageBucket:"expense---tracker-9957e.appspot.com",
messagingSenderId:"736738060052",
appId:"1:736738060052:web:7146800447fe6e47190401"
};
firebase.initializeApp(firebaseConfig);
</script>

<!-- ===== SIMPLE WORKING CALENDAR ===== -->
<script>
(function(){
var today=moment();

function Calendar(selector){
this.el=document.querySelector(selector);
this.current=moment().date(1);
this.draw();
}

Calendar.prototype.draw=function(){
this.drawHeader();
this.drawMonth();
};

Calendar.prototype.drawHeader=function(){
if(!this.header){
this.header=document.createElement("div");
this.header.className="header";

this.title=document.createElement("h1");

var right=document.createElement("div");
right.className="right";
right.onclick=()=>{
this.current.add(1,"month");
this.drawMonth();
};

var left=document.createElement("div");
left.className="left";
left.onclick=()=>{
this.current.subtract(1,"month");
this.drawMonth();
};

this.header.appendChild(this.title);
this.header.appendChild(right);
this.header.appendChild(left);
this.el.appendChild(this.header);
}
this.title.innerHTML=this.current.format("MMMM YYYY");
};

Calendar.prototype.drawMonth=function(){
if(this.month)this.month.remove();

this.month=document.createElement("div");
var start=this.current.clone().startOf("month").startOf("week");
var end=this.current.clone().endOf("month").endOf("week");

var date=start.clone();
while(date.isBefore(end)){
var day=document.createElement("div");
day.className="day";
day.innerHTML=
"<div>"+date.format("ddd")+"</div>"+
"<div>"+date.format("D")+"</div>";
this.month.appendChild(day);
date.add(1,"day");
}

this.el.appendChild(this.month);
};

new Calendar("#calendar");
})();
</script>

</body>
</html>
